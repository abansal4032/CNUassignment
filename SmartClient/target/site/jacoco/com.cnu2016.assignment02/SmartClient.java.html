<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SmartClient.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">assignment02</a> &gt; <a href="index.source.html" class="el_package">com.cnu2016.assignment02</a> &gt; <span class="el_source">SmartClient.java</span></div><h1>SmartClient.java</h1><pre class="source lang-java linenums">package com.cnu2016.assignment02;
import java.io.*;
import java.util.*;

<span class="fc" id="L5">enum status { ON, OFF };</span>

<span class="nc" id="L7">public class SmartClient {</span>
    
<span class="fc" id="L9">     static String Status = &quot;&quot;;</span>
     
     static String printStatus(status ACstatus, status WHstatus, status COstatus, long time)  {
<span class="fc" id="L12">            String StatusString = &quot;&quot;;</span>
<span class="fc" id="L13">            System.out.println(&quot;At time &quot; + time);</span>
<span class="fc" id="L14">            System.out.println(&quot;AC status &quot; + ACstatus);</span>
<span class="fc" id="L15">            System.out.println(&quot;WH status &quot; + WHstatus);</span>
<span class="fc" id="L16">            System.out.println(&quot;CO status &quot; + COstatus);</span>
<span class="fc" id="L17">            StatusString += &quot;At time &quot; + time + &quot; AC status &quot; + ACstatus + &quot; WH status &quot; + WHstatus + &quot; CO status &quot; + COstatus;</span>
<span class="fc" id="L18">            return StatusString;</span>
    }
        
        static void dotimer(Timer timer, TimerTask task, long time){//final Appliance AC, final Appliance WH, final Appliance CO, final String device, final status StatusToBe, final long time) {
<span class="fc" id="L22">                timer.schedule(task, time*1000);</span>
            
<span class="fc" id="L24">        }</span>
        
        static ArrayList&lt;String&gt; ReadFile(String file) throws IOException{
<span class="fc" id="L27">            ArrayList&lt;String&gt; CommandArray = new ArrayList&lt;String&gt;();</span>
<span class="fc" id="L28">            FileInputStream fstream = new FileInputStream(file);</span>
            // Get the object of DataInputStream
<span class="fc" id="L30">            DataInputStream in = new DataInputStream(fstream);</span>
<span class="fc" id="L31">            BufferedReader br = new BufferedReader(new InputStreamReader(in));</span>
            String strLine;
            //Read File Line By Line
<span class="fc bfc" id="L34" title="All 2 branches covered.">            while ((strLine = br.readLine()) != null)   {</span>
<span class="fc" id="L35">                CommandArray.add(strLine);</span>
            }
           
<span class="fc" id="L38">        return CommandArray;</span>
        }
        
        public static void main(String[] argvs) throws Exception{
<span class="nc" id="L42">            String Status = Client(&quot;textfile.txt&quot;);</span>
<span class="nc" id="L43">        }</span>

        static String Client(String TextFile) throws IOException, InterruptedException{
            //Get an instance for each Appliance
<span class="fc" id="L47">            final Appliance AC = new Appliance(status.OFF);</span>
<span class="fc" id="L48">            final Appliance WH = new Appliance(status.OFF);</span>
<span class="fc" id="L49">            final Appliance CO = new Appliance(status.OFF);</span>
<span class="fc" id="L50">        ArrayList&lt;String&gt; CommandArray = ReadFile(TextFile);</span>
<span class="fc" id="L51">        Collections.sort(CommandArray.subList(1, CommandArray.size()));</span>
<span class="fc" id="L52">        Timer timer = new Timer();</span>
<span class="fc bfc" id="L53" title="All 2 branches covered.">        for(int i=0;i&lt;CommandArray.size();i++){</span>
<span class="fc" id="L54">            String s = CommandArray.get(i);</span>
<span class="fc" id="L55">            String[] Command = s.split(&quot;,&quot;); </span>
<span class="fc" id="L56">            final long time = Long.valueOf(Command[0]).longValue();</span>
<span class="fc" id="L57">            final String device = Command[1];</span>
<span class="fc" id="L58">            final String stat = Command[2];</span>
            final status StatusToBe;
<span class="fc bfc" id="L60" title="All 2 branches covered.">            if(stat.equals(&quot;ON&quot;))</span>
<span class="fc" id="L61">                StatusToBe = status.ON;</span>
            else
<span class="fc" id="L63">                StatusToBe = status.OFF;</span>
<span class="fc" id="L64">                dotimer(timer,  new TimerTask() {</span>
                @Override
                //Check and display only if there is an actual change in status
                public void run() {
<span class="fc bfc" id="L68" title="All 2 branches covered.">                if(device.equals(&quot;AC&quot;))</span>
<span class="fc" id="L69">                    AC.setStatus(StatusToBe);</span>
<span class="fc bfc" id="L70" title="All 2 branches covered.">                if(device.equals(&quot;WH&quot;))</span>
<span class="fc" id="L71">                    WH.setStatus(StatusToBe);</span>
<span class="fc bfc" id="L72" title="All 2 branches covered.">                if(device.equals(&quot;CO&quot;))</span>
<span class="fc" id="L73">                    CO.setStatus(StatusToBe);</span>
<span class="fc" id="L74">                Status += printStatus(AC.getStatus(), WH.getStatus(), CO.getStatus(), time);</span>
<span class="fc" id="L75">                }}, time);</span>
            }
<span class="fc" id="L77">            Thread.sleep(10000);</span>
<span class="fc" id="L78">            timer.cancel();</span>

<span class="fc" id="L80">        return Status;</span>
        
}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>